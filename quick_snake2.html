<!DOCTYPE html>
<html lang="zh-CN">
    
<head>
    <meta charset="UTF-8">
    <title>快蛇</title>
    <style>
        body {
            display: flex;
            height: 100vh;
            margin: 0;
            padding: 0;
            justify-content: center;
            align-items: center;
            background-image: url('image/paper.gif');
        }
    </style>
    <link rel="shortcut icon" href="ta.ico" type="image/x-icon">
</head>

<body>
    <canvas id="can" width="400" height="400" style="background-color: black;"></canvas>
    <script>
        var snake = [48, 47, 46, 45, 44, 43, 42, 41, 40],
            direction = 1,
            food = 49,
            n,
            nm = 0;
        box = document.getElementById('can').getContext('2d');

        function randint(x, y) {
            return parseInt(Math.random() * (x - y + 1) + y);
        }

        function draw(seat, color) {
            box.fillStyle = color;
            box.fillRect(seat % 20 * 20 + 1, ~~(seat / 20) * 20 + 1, 18, 18);
        }
        document.onkeydown = function(evt) {
            direction = snake[1] - snake[0] == (n = [-1, -20, 1, 20][(evt || event).keyCode - 37] || direction) ? direction : n;
        };
        ! function() {
            var tem,
                flag;
            snake.unshift(n = snake[0] + direction);
            if (n < 0 || n > 399 || direction == 1 && n % 20 == 0 || direction == -1 && n % 20 == 19) {
                nm -= 1
                return alert("GAME OVER!" + nm + "分");
            }
            draw(n, "lime");
            if (n == food) {
                // while (snake.indexOf(food = randint(124, 129)) > 0);
                while (snake.indexOf(food = ~~(Math.random() * 400)) > 0);
                draw(food, "yellow");
                nm += 1
            } else {
                tem = snake.pop()
                draw(tem, "black")

            }
            for (i in snake) {
                if (snake[i] == tem) {
                    draw(tem, "lime");
                    break;
                };
            }
            setTimeout(arguments.callee, 88);
        }();
    </script>
</body>
